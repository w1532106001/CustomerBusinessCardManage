(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/input/input"],{"0234":function(e,o,t){"use strict";t.d(o,"b",(function(){return i})),t.d(o,"c",(function(){return s})),t.d(o,"a",(function(){return n}));var n={uniFilePicker:function(){return Promise.all([t.e("common/vendor"),t.e("uni_modules/uni-file-picker/components/uni-file-picker/uni-file-picker")]).then(t.bind(null,"8b1b"))},uIcon:function(){return Promise.all([t.e("common/vendor"),t.e("uni_modules/uview-ui/components/u-icon/u-icon")]).then(t.bind(null,"3139"))},uPicker:function(){return Promise.all([t.e("common/vendor"),t.e("uni_modules/uview-ui/components/u-picker/u-picker")]).then(t.bind(null,"7be8"))},uButton:function(){return Promise.all([t.e("common/vendor"),t.e("uni_modules/uview-ui/components/u-button/u-button")]).then(t.bind(null,"707d"))}},i=function(){var e=this,o=e.$createElement;e._self._c},s=[]},3236:function(e,o,t){},"480a":function(e,o,t){"use strict";var n=t("3236"),i=t.n(n);i.a},"8ac0":function(e,o,t){"use strict";(function(e){Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var t={data:function(){return{scrollTop:0,old:{scrollTop:0},imageValue:[],companyImageValue:[],imageStyles:{width:"160rpx",height:"160rpx",border:{color:"#BBBBBB",width:"2rpx",radius:"0rpx"}},listStyles:{border:!0,dividline:!0,borderStyle:{width:1,color:"blue",radius:2}},selectImagePath:"",companyPicturePath:"",imageData:"",type:1,detail:{},userInfo:{},classList:[],showClassPicker:!1,className:""}},onLoad:function(o){if(console.log("进入input页面"),this.userInfo=e.getStorageSync("userInfo"),this.classList=e.getStorageSync("classList"),o.detail){var t=JSON.parse(decodeURIComponent(o.detail));this.type=2,this.detail=t,this.imageValue=[{name:"file."+t.extname,extname:t.extname,url:getApp().globalData.baseUrl+t.picUrl}],this.companyImageValue=[{name:"file."+t.extname,extname:t.extname,url:getApp().globalData.baseUrl+t.companyPicUrl}],console.log("参数："+t.extname);var n=this.classList[0];for(var i in n){var s=n[i];if(s.id==this.detail.classId)return void(this.className=s.name)}}else this.type=1},methods:{select:function(e){this.selectImagePath=e.tempFilePaths[0],console.log("选择文件：",e),console.log("选择文件路径：",this.selectImagePath)},selectCompanyPicture:function(e){this.companyPicturePath=e.tempFilePaths[0],console.log("选择文件：",e),console.log("选择文件路径：",this.companyPicturePath)},progress:function(e){console.log("上传进度：",e)},success:function(e){console.log("上传成功")},fail:function(e){console.log("上传失败：",e)},upper:function(e){console.log(e)},lower:function(e){console.log(e)},scroll:function(e){console.log(e),this.old.scrollTop=e.detail.scrollTop},submit:function(){this.isEmpty(this.detail.name)?this.showEmptyToast("姓名"):this.isEmpty(this.detail.employeeName)?this.showEmptyToast("职位"):this.isEmpty(this.detail.phone)?this.showEmptyToast("电话"):this.isEmpty(this.detail.address)?this.showEmptyToast("地址"):this.isEmpty(this.detail.companyName)?this.showEmptyToast("企业名"):this.isEmpty(this.detail.companyIntroduction)?this.showEmptyToast("企业介绍"):this.isEmpty(this.detail.vrUrl)?this.showEmptyToast("VR地址"):this.selectImagePath||this.companyPicturePath?this.uploadFile():(e.showLoading({mask:!0}),1==this.type?this.newInfo():this.updateInfo())},uploadFile:function(){var o=this;console.log("图片数据"+this.selectImagePath),console.log("图片数据"+this.companyPicturePath),e.showLoading({mask:!0});var t=[];this.selectImagePath&&t.push(this.compressImage(this.selectImagePath)),this.companyPicturePath&&t.push(this.compressImage(this.companyPicturePath)),Promise.all(t).then((function(e){var t=[];console.log("图片压缩完成"),o.selectImagePath&&o.companyPicturePath?(t.push(o.uploadImage(e[0])),t.push(o.uploadCompanyImage(e[1])),console.log("上传用户与企业图片")):o.companyPicturePath?(console.log("上传企业图片"),t.push(o.uploadCompanyImage(e[0]))):(console.log("上传用户图片"),t.push(o.uploadImage(e[0]))),Promise.all(t).then((function(e){console.log("图片完成"),console.log(e),1==o.type?o.newInfo():o.updateInfo()})).catch((function(e){console.log(e)}))})).catch((function(e){console.log(e)}))},compressImage:function(o){return console.log("图片压缩"+o),new Promise((function(t,n){e.compressImage({src:o,quality:80,success:function(e){console.log("图片压缩成功"+e.tempFilePath),t(e.tempFilePath)},fail:function(o){console.log("图片压缩失败e:"+o),e.hideLoading(),e.showToast({duration:2e3,title:"图片压缩失败",icon:"error"}),n(o)}})}))},uploadImage:function(o){var t=this;return new Promise((function(n,i){e.uploadFile({url:getApp().globalData.baseUrl+"/upload",filePath:o,name:"file",header:{Authorization:t.userInfo.openId},success:function(o){if(console.log(o),200==o.statusCode){var s=JSON.parse(o.data).data;t.detail.picUrl=s,console.log("图片上传成功url:"+s),n(s)}else e.hideLoading(),e.showToast({title:o.errMsg,duration:2e3}),i(o.errMsg)},fail:function(o){e.hideLoading(),e.showToast({icon:"error",title:"图片上传失败",duration:2e3}),i(o)}})}))},uploadCompanyImage:function(o){var t=this;return new Promise((function(n,i){e.uploadFile({url:getApp().globalData.baseUrl+"/upload",filePath:o,name:"file",header:{Authorization:t.userInfo.openId},success:function(o){if(console.log(o),200==o.statusCode){var s=JSON.parse(o.data).data;t.detail.companyPicUrl=s,console.log("图片上传成功url:"+s),n(s)}else e.hideLoading(),e.showToast({title:o.errMsg,duration:2e3}),i(o.errMsg)},fail:function(o){e.hideLoading(),e.showToast({icon:"error",title:"图片上传失败",duration:2e3}),i(o)}})}))},updateInfo:function(){var o=this.detail;o.phone=parseInt(o.phone),console.log("detail"+JSON.stringify(this.detail)),e.request({method:"PUT",url:getApp().globalData.baseUrl+"/info/"+this.detail.id,data:o,header:{Authorization:this.userInfo.openId},success:function(o){console.log(o),e.hideLoading(),200==o.statusCode?(console.log("提交成功"),e.showToast({icon:"success",title:"提交成功",duration:2e3}),e.navigateBack()):e.showToast({title:o.errMsg,duration:2e3})},fail:function(o){console.log(o),e.hideLoading(),e.showToast({icon:"error",title:"提交失败",duration:2e3})}})},newInfo:function(o){var t=this.detail;t.phone=parseInt(t.phone),console.log("detail"+JSON.stringify(this.detail)),console.log("userInfo"+JSON.stringify(this.userInfo)),e.request({method:"POST",url:getApp().globalData.baseUrl+"/info",data:t,header:{Authorization:this.userInfo.openId},success:function(o){console.log(o),e.hideLoading(),200==o.statusCode?(e.showToast({icon:"success",title:"提交成功",duration:2e3}),console.log("提交成功"),e.navigateBack()):e.showToast({title:"提交失败",duration:2e3})},fail:function(o){console.log(o),e.hideLoading(),e.showToast({icon:"error",title:"提交失败",duration:2e3})}})},showEmptyToast:function(o){e.showToast({title:o+"不能为空",icon:"error",duration:2e3})},isEmpty:function(e){return!e||0===e.length},onPickerCancel:function(){this.showClassPicker=!1},onPickerConfirm:function(e){this.showClassPicker=!1;var o=e.values[0][e.indexs[0]];this.detail.classId=o.id,this.className=o.name},showClassPickerFun:function(){this.showClassPicker=!0}}};o.default=t}).call(this,t("543d")["default"])},d75f:function(e,o,t){"use strict";t.r(o);var n=t("8ac0"),i=t.n(n);for(var s in n)"default"!==s&&function(e){t.d(o,e,(function(){return n[e]}))}(s);o["default"]=i.a},f6a1:function(e,o,t){"use strict";(function(e){t("c2c7");n(t("66fd"));var o=n(t("fdd5"));function n(e){return e&&e.__esModule?e:{default:e}}wx.__webpack_require_UNI_MP_PLUGIN__=t,e(o.default)}).call(this,t("543d")["createPage"])},fdd5:function(e,o,t){"use strict";t.r(o);var n=t("0234"),i=t("d75f");for(var s in i)"default"!==s&&function(e){t.d(o,e,(function(){return i[e]}))}(s);t("480a");var a,l=t("f0c5"),c=Object(l["a"])(i["default"],n["b"],n["c"],!1,null,null,null,!1,n["a"],a);o["default"]=c.exports}},[["f6a1","common/runtime","common/vendor"]]]);